---
title: 高度な計算列のタイプ
description: ほとんどの使用例に関する基本事項を説明します。ただし、Data Warehouseマネージャで作成できるものよりも少し複雑な計算列が必要な場合もあります。
exl-id: 9871fa19-95b3-46e4-ae2d-bd7c524d12db
source-git-commit: fa954868177b79d703a601a55b9e549ec1bd425e
workflow-type: tm+mt
source-wordcount: '912'
ht-degree: 4%

---

# 高度な計算列のタイプ

作成しようとする多くの分析には、 **新しい列** を `group by` または `filter by`. この [計算列の作成](../data-warehouse-mgr/creating-calculated-columns.md) チュートリアルではほとんどの使用例について基本的な説明をしますが、Data Warehouseマネージャーで作成できるものよりも少し複雑な計算列が必要な場合があります。
{:#top}

これらのタイプの列は、アドビのData Warehouseアナリストチームが作成できます。 新しい計算列を定義するには、次の情報を入力します。

1. この **`definition`** この列の（入力、数式、書式を含む）
1. この **`table`** 列を作成する対象
1. 任意 **`example data points`** 列に含める内容を記述する

次に、高度な計算列の一般的な例を示します。

* [イベントを順番に並べ替える（またはランク付けする）](#compareevents)
* [2 つのイベント間の時間を見つける](#twoevents)
* [順次イベント値の比較](#sequence)
* [変換通貨](#currency)
* [タイムゾーンの変換](#timezone)
* [他のもの](#else)

## イベントを順番に並べようとしています {#compareevents}

これを、 **イベント番号** 計算列。 つまり、顧客やユーザーなど、特定のイベント所有者に対してイベントが発生した順序を見つけようとしています。

次に例を示します。

| **`event\_id`** | **`owner\_id`** | **`timestamp`** | **`Owner's event number`** |
|-----|-----|-----|-----|
| 1 | `A` | 2015-01-01 00:00:00 | 1 |
| 2 | `B` | 2015-01-01 00:30:00 | 1 |
| 3 | `A` | 2015-01-01 02:00:00 | 2 |
| 4 | `A` | 2015-01-02 13:00:00 | 3 |
| 5 | `B` | 2015-01-03 13:00:00 | 2 |

{style=&quot;table-layout:auto&quot;}

イベント番号計算列を使用して、データ内の初回イベント、繰り返しイベントまたは n 番目のイベントの動作の違いを観察できます。

顧客の注文番号列を実際に表示したい場合は、 画像をクリックすると、レポートでグループ化ディメンションとして使用されるのが表示されます。

![イベント番号計算列を使用して、顧客の注文番号でグループ化します。](../../assets/EventNumber.gif)<!--{: style="max-width: 500px;"}-->

このタイプの計算列を作成するには、次の点について理解する必要があります。

* この列を作成するテーブル
* イベントの所有者を識別するフィールド (`owner\_id` （この例では）
* イベントの並べ替えに使用するフィールド (`timestamp` （この例では）

[トップに戻る](#top)

## 私は 2 つの出来事の間の時間を見つけようとしています。 {#twoevents}

これを、 `date difference` 計算列。 つまり、イベントのタイムスタンプに基づいて、1 つのレコードに属する 2 つのイベント間の時間を見つけようとしています。

次に例を示します。

| `id` | `timestamp\_1` | `timestamp\_2` | `Seconds between timestamp\_2 and timestamp\_1` |
|-----|-----|-----|-----|
| `A` | 2015-01-01 00:00:00 | 2015-01-01 12:30:00 | 45000 |
| `B` | 2015-01-01 08:00:00 | 2015-01-01 10:00:00 | 7200 |

{style=&quot;table-layout:auto&quot;}

日付差計算列を使用して、2 つのイベント間の平均時間または中央値時間を計算する指標を作成できます。 以下の画像をクリックして、 `Average time to first order` 指標がレポートで使用されます。

![日付の差異計算列を使用して、最初の注文までの平均時間を計算します。](../../assets/DateDifference.gif)<!--{: style="max-width: 500px;"}-->

このタイプの計算列を作成するには、次の点について理解する必要があります。

* この列を作成するテーブル
* 違いを知りたい 2 つのタイムスタンプ

[トップに戻る](#top)

## 順次イベント値を比較しようとしています。 {#sequence}

これを、 **順次イベント比較**. つまり、値（通貨、数値、タイムスタンプ）と、所有者の前のイベントに対応する値との差分を見つけようとしています。

次に例を示します。

| **`event\_id`** | **`owner\_id`** | **`timestamp`** | **`Seconds since owner's previous event`** |
|-----|-----|-----|-----|
| 1 | `A` | 2015-01-01 00:00:00 | NULL |
| 2 | `B` | 2015-01-01 00:30:00 | NULL |
| 3 | `A` | 2015-01-01 02:00:00 | 7720 |
| 4 | `A` | 2015-01-02 13:00:00 | 126000 |
| 5 | `B` | 2015-01-03 13:00:00 | 217800 |

{style=&quot;table-layout:auto&quot;}

順次イベントの比較は、各順次イベント間の平均時間または中央値時間を見つけるために使用できます。 以下の画像をクリックして、 **注文間の平均時間と中央値時間** 指標を使用します。

=![順次イベント比較計算列を使用して、注文間の平均時間と中央値時間を計算します。](../../assets/SeqEventComp.gif)<!--{: style="max-width: 500px;"}-->

このタイプの計算列を作成するには、次の点について理解する必要があります。

* この列を作成するテーブル
* イベントの所有者を識別するフィールド (`owner\_id` （例では）
* 各順次イベントの差を表示する値フィールド (`timestamp` （この例では）

[トップに戻る](#top)

## 私は通貨を換算しようとしています。 {#currency}

A **通貨コンバージョン** 計算列は、イベント時の為替レートに基づいて、トランザクション金額を記録済み通貨からレポート通貨に変換します。

次に例を示します。

| **`id`** | **`timestamp`** | **`transaction\_value\_EUR`** | **`transaction\_value\_USD`** |
|-----|-----|-----|-----|
| `1` | 2015-01-01 00:00:00 | 30 | 33.57 |
| `2` | 2015-01-02 00:00:00 | 50 | 55.93 |

{style=&quot;table-layout:auto&quot;}

このタイプの計算列を作成するには、次の点について理解する必要があります。

* この列を作成するテーブル
* 変換するトランザクション金額列
* データが記録された通貨を示す列（通常は ISO コード）
* 推奨レポート通貨

[トップに戻る](#top)

## タイムゾーンを変換しようとしています。 {#timezone}

A **タイムゾーン変換** 計算列は、特定のデータソースのタイムスタンプを、記録されたタイムゾーンからレポートタイムゾーンに変換します。

次に例を示します。

| **`id`** | **`timestamp\_UTC`** | **`timestamp\_ET`** |
|-----|-----|-----|
| `1` | 2015-01-01 00:00:00 | 2014-12-31 19:00:00 |
| `2` | 2015-01-01 12:00:00 | 2015-01-01 07:00:00 |

{style=&quot;table-layout:auto&quot;}

このタイプの計算列を作成するには、次の点について理解する必要があります。

* この列を作成するテーブル
* 変換するタイムスタンプ列
* データが記録されたタイムゾーン
* 推奨されるレポートタイムゾーン

[トップに戻る](#top)

## 私はここに記載されていないことをしようとしています。 {#else}

心配しないで。 ここに記載されていないので、実行できないとは限りません。 当社のData Warehouseアナリストチームが対象です。

新しい計算列を定義するには、次の手順を実行します。 [サポートチケットを提出する](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/miscellaneous/mbi-service-policies.html?lang=en) に、作成する内容の詳細を示します。

## 関連ドキュメント

* [計算列の作成](../data-warehouse-mgr/creating-calculated-columns.md)
* [計算列のタイプ](../data-warehouse-mgr/calc-column-types.md)
* [建物 [!DNL Google ECommerce] 注文と顧客データを含むディメンション](../data-warehouse-mgr/bldg-google-ecomm-dim.md)
