---
title: レプリケーションメソッドの設定
description: テーブルの編成方法と、テーブルデータの動作によって、テーブルに最適なレプリケーション方法を選択する方法を説明します。
exl-id: 83895c48-a6ec-4b01-9890-164e0b21dcbc
source-git-commit: c7f6bacd49487cd13c4347fe6dd46d6a10613942
workflow-type: tm+mt
source-wordcount: '1414'
ht-degree: 0%

---

# レプリケーションメソッドの設定

`Replication` メソッドと [再チェック](../data-warehouse-mgr/cfg-data-rechecks.md) は、データベーステーブル内の新しいデータや更新されたデータを識別するために使用されます。 データの正確性と最適化された更新時間の両方を確保するには、正しく設定することが重要です。 このトピックでは、レプリケーション方法に焦点を当てます。

で新しいテーブルが同期されたとき [Data Warehouse管理](../data-warehouse-mgr/tour-dwm.md)を指定した場合、レプリケーション方法がテーブルに対して自動的に選択されます。 様々なレプリケーション方法、テーブルの編成方法、およびテーブルデータの動作を理解することで、テーブルに最適なレプリケーション方法を選択できます。

## レプリケーション方法について教えてください。

`Replication` メソッドは 3 つのグループに分かれます。 `Incremental`, `Full Table`、および `Paused`.

[**[!UICONTROL Incremental Replication]**](#incremental) はを意味する [!DNL Commerce Intelligence] レプリケーションを試みるたびに、新しいデータまたは更新されたデータのみをレプリケートします。 これらの方法により遅延が大幅に削減されるので、Adobeでは可能な限り使用することをお勧めします。

[**[!UICONTROL Full Table Replication]**](#fulltable) はを意味する [!DNL Commerce Intelligence] レプリケーションの試行のたびに、テーブルの内容全体をレプリケートします。 レプリケートされるデータが大量に存在する可能性があるので、これらの方法によって待ち時間や更新時間が長くなる可能性があります。 テーブルにタイムスタンプ付きの列または日時の列が含まれる場合、Adobeでは、代わりに増分方式を使用することをお勧めします。

**[!UICONTROL Paused]** テーブルのレプリケーションが停止または一時停止されたことを示します。 [!DNL Commerce Intelligence] 更新サイクル中は、新しいデータや更新されたデータを確認しません。つまり、レプリケーションメソッドとしてこれを持つテーブルからデータがレプリケートされることはありません。

## 増分レプリケーション方法 {#incremental}

### 修正時刻（最も理想的）

この `Modified At` レプリケーション方法では、datetime 列を使用します。datetime 列は、行が作成されたときに入力され、データが変更されたときに更新されます。この列は、レプリケートするデータを検索します。 このメソッドは、次の条件を満たすテーブルを操作するように設計されています。

* 次を含む `datetime` 行が作成されたときに最初に入力され、行が変更されるたびに更新される列。
* の `datetime` 列が null になることはありません。
* 行がテーブルから削除されない

Adobeは、これらの条件に加えて、 **インデックス** の `datetime` 使用する列 `Modified At` レプリケーションは、レプリケーション速度の最適化に役立ちます。

更新を実行すると、新しいデータまたは変更されたデータが、 `datetime` 列内の最新の更新後に発生した値です。 新しい行が検出されると、それらはData Warehouseにレプリケートされます。 行が [Data Warehouse管理](../data-warehouse-mgr/tour-dwm.md)を指定した場合、現在のデータベース値で上書きされます。

例えば、テーブルに「 `modified\_at` これは、最後にデータが変更された時間を示します。 最新の更新が火曜日の正午に実行された場合、更新では、 `modified\_at` 値が火曜日の正午より大きい。 火曜日の正午以降に作成または変更された、検出されたすべての行は、Data Warehouseにレプリケートされます。

**知ってたの？**
データベースで `Incremental` レプリケーション方法を使用すると、次のことが可能になります。 [データベースに変更を加える](../../best-practices/mod-db-inc-replication.md) それは使用を可能にする `Modified At` または `Single Auto Incrementing PK`.

`Modified At` は最も理想的なレプリケーション方法であるだけでなく、最も速いレプリケーション方法です。 この方法では、大きなデータセットで顕著な速度の増加が生じるだけでなく、再チェックオプションを設定する必要もありません。 その他のメソッドでは、データの小さなサブセットが変更された場合でも、テーブル全体を繰り返し処理して変更を識別する必要があります。 `Modified At` この小さなサブセットのみを反復します。

### 単一の自動増分プライマリキー

`Auto Incrementing` は、プライマリキーを順番に行に割り当てる動作です。 テーブルが `Auto Incrementing` テーブル内の最も大きいプライマリキーが 1,000 で、次のプライマリ値が 1,001 以上になります。 を使用しないテーブル `Auto Incrementing` 動作によって、1,000 未満のプライマリキー値が割り当てられたり、はるかに大きな数にジャンプしたりする場合がありますが、一般的には使用されません。

この方法は、次の条件を満たすテーブルから新しいデータをレプリケートするように設計されています。

* `single-column primary key`;および
* `primary key` データ型は `integer`;および
* `auto incrementing` プライマリキーの値。

テーブルが `Single Auto Incrementing Primary Key` レプリケーションでは、Data Warehouse内で現在最も大きい値を超えるプライマリキー値を検索することで、新しいデータが検出されます。 例えば、Data Warehouseで最も大きいプライマリキーの値が 500 の場合、次の更新が実行されると、プライマリキーの値が 501 以上の行が検索されます。

### 日付を追加

この `Add Date` メソッドは `Single Auto Incrementing Primary Key` メソッド。 このメソッドでは、テーブルのプライマリキーに整数を使用する代わりに、 `timestamped` 列をクリックして新しい行を確認します。

テーブルが `Add Date` レプリケーションでは、Data Warehouseに同期された最新の日付より大きいタイムスタンプ値を検索することで、新しいデータが検出されます。 例えば、最後に更新が実行されたのが20/12/2015 09 の場合:00:00 の場合、タイムスタンプがこれより大きいすべての行は、新しいデータとしてマークされ、レプリケートされます。

>[!NOTE]
>
>とは異なり、 `Modified At` メソッド `Add Date` では、既存の行の更新情報を確認しません。新しい行のみを探します。

## フルテーブルレプリケーションメソッド {#fulltable}

### フルテーブル

`Full table` レプリケーションは、新しい行が検出されるたびにテーブル全体を更新します。 新しい行があると仮定して、更新のたびにすべてのデータを再処理する必要があるので、これは非常に効率的なレプリケーション方法ではありません。

同期プロセスの開始時にデータベースを照会し、行数をカウントすることで、新しい行が検出されます。 ローカルデータベースの行数が [!DNL Commerce Intelligence]を指定した場合、テーブルが更新されます。 行数が同じ場合、または [!DNL Commerce Intelligence] 次を含む *詳細* 行がローカルデータベースよりも多い場合、テーブルはスキップされます。

これは重要な点を浮き彫りにする **`Full Table`次の場合はレプリケーションに互換性がありません：**

* 後続の更新サイクルの間に、ローカルデータベーステーブルで作成されたよりも多くの行が削除されました。
* 列の値は変更されますが、追加の行は作成されません

上記のシナリオのいずれかで、 `Full Table` レプリケーションで変更が検出されず、データが古くなります。 このレプリケーション方法の効率が悪く、前述の要件が原因です。 `Full Table` レプリケーションは、最後の手段としてのみ推奨されます。

### プライマリキーバッチ

テーブルが `Primary Key Batch` （PK バッチ）、プライマリキー値の範囲内の行（バッチ）をカウントすることで、新しいデータが検出されます。 通常、これは整数で使用されると考えられますが、テキスト値でも、定数範囲を定義できるように並べ替えることができます。

例えば、更新が実行され、1 ～ 100 のキーの範囲の行数を実行するとします。 この更新では、37 行が検出され、ログに記録されます。 次の更新では、1～100 の範囲で行数が再び実行され、41 行が見つかります。 前回の更新と比較した行数に違いがあるので、システムはその範囲（またはバッチ）をより詳細に調べます。

このメソッドは、次の条件を満たすテーブルからデータをレプリケートすることを目的としています。

* 1 列の非整数；または
* 複合キー（主キーを構成する複数の列） — 複合主キーで使用される列に null 値を含めることはできません。または
* 単一列、整数、自動増分以外のプライマリキー値。

バッチを調べて変更を見つけるために必要な処理量が多いので、この方法は非常に遅いので、理想的ではありません。 Adobeでは、他のレプリケーション方法をサポートするために必要な変更を行うことができない場合を除き、この方法を使用しないことをお勧めします。 このメソッドを使用する必要がある場合は、更新時間が長くなることを期待します。

## レプリケーションメソッドの設定

レプリケーションメソッドは、テーブルごとに設定されます。 テーブルのレプリケーションメソッドを設定するには、次が必要です [`Admin`](../../administrator/user-management/user-management.md) 権限を設定して、Data Warehouseマネージャーにアクセスできます。

1. Data Warehouseマネージャで、 `Synced Tables` リストを使用して、テーブルのスキーマを表示します。
1. 現在のレプリケーションメソッドは、テーブル名の下に表示されます。 変更するには、リンクをクリックします。
1. 表示されるポップアップで、次のいずれかの横にあるラジオボタンをクリックします。 `Incremental` または `Full Table` レプリケーションタイプを選択します。
1. 次に、 **[!UICONTROL Replication Method]** ドロップダウンを使用してメソッドを選択します。 例： `Paused` または `Modified At`.

   >[!NOTE]
   >
   >**一部の増分処理メソッドでは、`Replication Key`**. [!DNL Commerce Intelligence] は、次の更新サイクルを開始する場所を決定するために、このキーを使用します。
   >
   >例えば、 `modified at` メソッド `orders` テーブルを選択する場合は、 `date column` をレプリケーションキーとして使用します。 複製キーには複数のオプションが存在する場合がありますが、「 `created at`または注文が作成された時刻。 最後の更新サイクルが12/1/2015 00 で停止した場合:10:00：次のサイクルでは、 `created at` これより大きい日付。

1. 終了したら、 **[!UICONTROL Save]**.

プロセス全体を見てみましょう。

![](../../assets/replication_method.gif)<!--{: width="801" height="341"}-->

## 折り返し

最後に、様々なレプリケーション方法を比較したこの表をまとめました。 Data Warehouse内のテーブルのメソッドを選択する場合は、非常に便利です。

| **`Method`** | **`Syncing New Data`** | **`Processing Rechecks on Large Data Sets`** | **`Handle Composite Keys?`** | **`Handle Non-Integer PKs?`** | **`Handle Non-Sequential PK Population?`** | **`Handle Row Deletion?`** |
|-----|-----|-----|-----|-----|-----|-----|
| `Auto-Incrementing Primary Key` | より高速 | 遅い | いいえ | いいえ | いいえ | はい |
| `Primary Key Batch Monitoring` | 遅い | 遅い | はい | はい | はい | はい |
| `Modified At` | より高速 | より高速 | はい | はい | はい | いいえ |

{style="table-layout:auto"}

## 関連ドキュメント

* [データ再チェックについて](../data-warehouse-mgr/cfg-data-rechecks.md)
* [をサポートするようにデータベースを変更中 ](../../best-practices/mod-db-inc-replication.md)
* [分析用にデータベースを最適化中](../../best-practices/opt-db-analysis.md)
* [更新時間の短縮](../../best-practices/reduce-update-cycle-time.md)
