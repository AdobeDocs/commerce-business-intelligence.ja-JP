---
title: 詳細 [!DNL MBI] 環境
description: の操作と改善について [!DNL MBI] 環境。
exl-id: 601b5fba-da02-4cc8-96ed-147c24f326f9
source-git-commit: fa954868177b79d703a601a55b9e549ec1bd425e
workflow-type: tm+mt
source-wordcount: '780'
ht-degree: 0%

---

# お使いの [!DNL MBI] 環境

コマースデータを分析する際は、これらの要因と一般的な誤解に注意してください。 コマーススキーマを正しく使用するためにサポートが必要な場合は、次の点に気を配らずにお使いください。 [連絡先サポート](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/miscellaneous/mbi-service-policies.html?lang=en).

## [!DNL entity\_id]

テーブルの多くには、 `entity\_id`. を含む各テーブルで、 `entity\_id`の場合、その列を使用して一意の行を識別します。

例えば、 `sales\_order` テーブルは一意の順序です。 このテーブルのプライマリキーは、と呼ばれます。 `entity\_id`. この列は、 `order\_id`. 別のテーブルで、 `customer\_entity`の各行は、個別の顧客を表します。 このテーブルのプライマリキーは、 `entity\_id`は、 `customer\_id`.

この表では `sales\_order.entity\_id` 次と等しくない `customer\_entity.entity\_id`. これは、を含むすべてのテーブルセットに対して当てはまります。 `entity\_id`: `table\_A.entity\_id` 次と等しくない `table\_B.entity\_id`.

## [!DNL Guest orders]

アカウントを持たずにサイトからの注文を許可した場合（ゲストによる注文）、その顧客は `customer\_entity` 表。 また、ゲストによって配信された各注文には、null が含まれます `customer\_id` 値 `sales\_order` 表。

したがって、ゲストの行動を時間の経過と共に追跡する場合は、すべての顧客レベルの列を `sales\_order` テーブル、顧客 ID（例： ）を使用 `customer\_email`.

次を利用する場合、 `sales\_order` 表を顧客テーブルとして使用する場合は、顧客レベルの指標を作成する際に注意する必要があります。 例えば、平均ライフタイム売上高指標を考えてみましょう。 この指標は、顧客ベース全体での平均ライフタイム売上高を識別するために使用されます。 まず、各顧客の全期間売上高を返す新しい列が必要です。 次に、この列の平均値を算出して、顧客のライフタイム平均売上高を得る必要があります。

次の条件を満たす `customer\_entity` テーブルの場合、各行は 1 人の顧客で、各顧客はそのテーブルに 1 回だけ存在します。 したがって、全期間の売上高列がある場合は、平均指標を作成するだけで済みます。 ただし、 `sales\_order` テーブルは、顧客テーブルと同様に、顧客は多数の行に存在する可能性があります。 全期間売上高列を設定した後、特定の顧客が行った各注文（行）には、顧客の全期間売上高が表示されます。ただし、全体の平均指標に 1 回だけその顧客を含めたい場合は、

ここでのトリックは、各顧客を 1 回だけ含めるように指標にフィルターを追加する必要があるということです。 という名前のフィルターセットを作成して使用することをお勧めします。 **カウントする顧客** をフィルターする **顧客の注文番号= 1** （他のフィルターの中でも、不要な顧客を除外する必要が生じる場合があります）。 このフィルターを追加すると、各顧客が 1 回だけ顧客レベルの指標に含まれるようになります。

## 製品とカテゴリ

商品は複数のカテゴリを持つことができ、カテゴリは複数の商品に使用できます。 したがって、カテゴリレベルの分析を設定する場合は、正しい定義を使用するように注意する必要があります。 トップレベルのカテゴリを選択しますか？ 第 2 レベルのカテゴリですか？ 製品が複数のトップレベルカテゴリに分類される場合はどうすればよいですか？

コマース実装で定義された、3 つの異なるカテゴリレベルに分類されるジーンズのペアを想像してみましょう。「服」（トップレベル）、「アウターウェア」（セカンドレベル）、「パンツ」（サードレベル）。 販売数量別にカテゴリの実績を分析することができます。 この分析に必要な指標は次のとおりです。 _販売済みアイテム_: `sales\_order\_item` 表。 したがって、カテゴリレベルの情報を項目テーブルに移動する必要があります。 各行 `sales\_order\_item` テーブルには関連付けられています `product\_id`製品に関連付けられているカテゴリがわかっている場合は、その情報を目的のテーブルに取り込むことができます。

データを移動する前に、まず適切な結合とフィルターを把握し、正しいカテゴリを取得するようにする必要があります。 一部の分析では、「パンツ」を知る必要が生じる場合がありますが、他の分析では「服」の方が適切な場合があります。 これらは、別々に識別される異なるカテゴリです。 各カテゴリレベルの定義方法を把握することで、単体販売を特定の分析に適したカテゴリに関連付けることができます。

次に、Web サイトのホームページに「お気に入り」の最上位カテゴリがあるとします。 おそらく、これらのジーンズを「服」カテゴリと「お気に入り」カテゴリの両方に含めるために、コマースストアを実装しています。 その場合、このジーンズのペアは、複数のトップレベルカテゴリを持ちます。 その場合、単一の最上位カテゴリを `sales\_order\_item` 複数のオプションがあるので、テーブルはまだ意味をなさない。 これを考慮するには、特定のカテゴリを確認する yes/no 列を作成することをお勧めします。 例： `Is product in Clothing category?` および `Is product in Our Favorites category?` 列を使用すると、製品が特定のカテゴリに該当するかどうかを確認できます。
