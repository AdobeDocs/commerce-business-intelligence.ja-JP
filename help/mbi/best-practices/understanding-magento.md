---
title: 環境  [!DNL Commerce Intelligence]  把握
description: 環境での作業と改善について説明  [!DNL Commerce Intelligence]  ます。
exl-id: 601b5fba-da02-4cc8-96ed-147c24f326f9
role: Admin, Data Architect, Data Engineer, User
feature: Data Warehouse Manager
source-git-commit: adb7aaef1cf914d43348abf5c7e4bec7c51bed0c
workflow-type: tm+mt
source-wordcount: '749'
ht-degree: 0%

---

# [!DNL Adobe Commerce Intelligence] 環境

コマースデータを分析する際は、これらの要因と一般的な誤解に注意してください。 Commerce スキーマを正しく使用していることを確認するためにサポートが必要な場合は、ためらわずに [ サポートにお問い合わせください ](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/miscellaneous/mbi-service-policies.html?lang=ja)。

## [!DNL entity\_id]

テーブルの多くには、`entity\_id` という名前の列が含まれています。 `entity\_id` を含む各テーブルでは、その列を使用して一意の行を識別します。

例えば、`sales\_order` テーブルの各行は一意の順序です。 このテーブルの主キーは `entity\_id` です。 この列は `order\_id` と考えることができます。 個別のテーブルでは、各行 `customer\_entity` 一意の顧客を表します。 このテーブルのプライマリキーは `entity\_id` とも呼ばれ、`customer\_id` と考えることができます。

これらのテーブルでは、`sales\_order.entity\_id` は `customer\_entity.entity\_id` と等しくありません。 これは、`entity\_id` を含むすべてのテーブルのセットに対して true です。`table\_A.entity\_id` は `table\_B.entity\_id` と等しくありません。

## [!DNL Guest orders]

顧客がアカウントを持たずにサイトから注文できるようにする（ゲスト注文）場合、それらの顧客は `customer\_entity` テーブルの行として入力されません。 また、ゲストが行った各注文の `customer\_id` テーブルには null`sales\_order` 値が含まれます。

したがって、ゲストの行動を経時的に追跡する場合は、`sales\_order` などの顧客識別子を使用して、`customer\_email` テーブルですべての顧客レベル列を計算する必要があります。

`sales\_order` テーブルを顧客テーブルとして使用する場合は、顧客レベルの指標を作成する際に注意する必要があります。 例えば、平均生涯売上高指標について考えてみましょう。 この指標は、顧客ベース全体の平均生涯売上高を特定するために使用されます。 これには、顧客ごとに生涯売上高を返す新しい列が最初に必要です。 次に、この列を平均して、顧客の平均生涯売上高を取得する必要があります。

`customer\_entity` テーブルを使用できる場合、各行は単一の顧客であり、各顧客はそのテーブルに 1 回だけ存在します。 したがって、「生涯売上高」列が表示されている場合は、平均指標を作成するだけで済みます。 ただし、`sales\_order` テーブルを顧客テーブルとして使用する場合、顧客が多数の行に存在する可能性があります。 ライフタイム収益列を設定した後、特定の顧客によって行われた各注文（行）は、その顧客のライフタイム収益を表示しますが、その顧客を全体的な平均指標に含めるのは 1 回だけです。

このコツは、各顧客を 1 回だけ含めるフィルターを指標に追加する必要があることです。 Adobeでは、**Customer&#39;s order number = 1** でフィルタリングする **Customers we count** という名前のフィルターセットを作成して使用することをお勧めします（他のフィルターでは、不要な顧客を除外する必要が生じる場合があります）。 このフィルターを追加すると、顧客レベルの指標に各顧客を 1 回だけ含めることができます。

## 製品とカテゴリ

製品には複数のカテゴリを設定でき、複数の製品にカテゴリを使用できます。 したがって、カテゴリレベルの分析を設定する場合は、正しい定義を使用するように注意する必要があります。 最上位のカテゴリが必要ですか？ 第 2 レベルのカテゴリ？ 製品が複数のトップレベルカテゴリに分類できる場合はどうすればよいですか？

Commerceの実装で定義されているように、「衣類」（トップレベル）、「アウターウェア」（第 2 レベル）、「パンツ」（第 3 レベル）の 3 つの異なるカテゴリレベルに分類されるジーンズを考えてみます。 カテゴリのパフォーマンスを販売単位数で分析することをお勧めします。 この分析に必要な指標は、_テーブルに基づいて構築された_ 販売された項目 `sales\_order\_item` です。 したがって、カテゴリレベルの情報を項目テーブルに移動する必要があります。 `sales\_order\_item` テーブルの各行には `product\_id` が関連付けられているので、製品に関連付けられているカテゴリがわかっている場合は、その情報を目的のテーブルに引き継ぐことができます。

データを移動する前に、適切な結合とフィルターを理解して、正しいカテゴリを確実に取得する必要があります。 一部の分析では「パンツ」を知る必要がある場合がありますが、他の分析では、「衣類」の方が適切な場合があります。 これらは、別個に識別される別個のカテゴリです。 各カテゴリ・レベルの定義方法を把握することにより、特定の分析に対してユニット売上を適切なカテゴリに関連付けることができます。

次に、web サイトのホームページに `Our Favorites` の最上位のカテゴリがあると仮定します。 おそらく、Commerce ストアを実装して、これらのジーンズを `Clothing` カテゴリと `Our Favorites` カテゴリの両方に含めたことでしょう。 その場合、このジーンズのペアには複数の最上位カテゴリがあります。 その場合、複数のオプションがあるので、1 つの最上位カテゴリを `sales\_order\_item` テーブルに移動しても意味をなしません。 これに対処するために、Adobeでは、特定のカテゴリをチェックする「はい/いいえ」の列を作成することをお勧めします。 例えば、`Is product in Clothing category?` 列と `Is product in Our Favorites category?` 列を使用すると、製品がこれらの特定のカテゴリに該当するかどうかを確認できます。
