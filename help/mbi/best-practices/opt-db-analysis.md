---
title: 分析用にデータベースを最適化中
description: 分析用にデータベースを最適化する方法を説明します。
exl-id: e73e1a1e-c933-476d-97bc-bd8f52bb2fa1
source-git-commit: 03a5161930cafcbe600b96465ee0fc0ecb25cae8
workflow-type: tm+mt
source-wordcount: '893'
ht-degree: 0%

---

# データベースの最適化

ビジネス・インテリジェンスにオペレーショナル・データベースを使用する主なメリットは、データを収集するために何も作成または変更する必要がないことです。 貴重な情報は既に存在し、ロックを解除するだけです。

このトピックには、分析用にデータベースを最適化し、生データから実用的なインサイトを引き出すのに役立つ推奨事項が含まれています。

## データを削除しない

>[!TIP]
>
>お客様のビジネス（およびお客様独自のサービス利用条件）に影響を与える現地法および国際法は、保持できるデータの種類と、その保持期間に影響を与える場合があります。 これらの法律を順守することが最優先課題です。

注文がキャンセルされた場合、ユーザーが自分のアカウントを無効にした場合、または製品が廃止された場合は、データベース内の関連情報が削除されやすくなります。 テーブルが増え、混乱をなくすのは、慎重な考えのようです。 ただし、行を削除すると、この情報は永久に失われるか、古いバックアップを調べて見つける必要が生じます。

代わりに、行がアクティブでなくなったか関連性がなくなったかを示すステータス列をテーブルに追加できます。 また、変更日を格納する列を追加するか、変更履歴のログを作成することもお勧めします。 テーブルの大きさが大きくなり、パフォーマンスが低下し始める場合は、分析に使用するテーブルに古いデータをアーカイブすることを検討してください。

## ほとんどデータを上書きしない

データの上書きは慎重に慎重におこなう必要があります。

例えば、ログイン日を使用すると、多くの企業ではログイン履歴のテーブルではなく、最後のログイン日が保存されます。 機能上、最後のログイン日が必要になる場合がありますが、上書きされたデータは、分析の観点からは大きな損失となります。 これらのアクションの完全なログを保持しないと、長期間滞在した後に再アクティブ化したユーザー数を確認できなくなります。 また、ユーザーエンゲージメントコホート分析などのログインに基づく分析を構築することもできません。

原則として、何らかのユーザー操作によってレコードを更新する場合は、以前のユーザー操作や別のユーザー操作に関する情報を上書きしないでください。

## 次を含む `Updated_at` 時間の経過と共に更新されるデータの列

テーブルの行の値が時間の経過と共に変化する場合（例： ） **order\_status** 次の変更：`processing` から `complete`、 **updated\_at** 列には、最新の変更がいつおこなわれるかが記録されます。 必ず **updated\_at** の値は、最初に新しいデータ行を挿入したとき ( その時点で **updated\_at** 日付は、 **created\_at** 日付。

分析の最適化に加えて、 **updated\_at** 列では、 [増分レプリケーションメソッド](../data-analyst/data-warehouse-mgr/cfg-replication-methods.md)：更新サイクルの長さを短縮するのに役立ちます。

## ユーザー獲得ソースを保存

最も一般的な間違いの 1 つは [ユーザー獲得ソース](../data-analyst/analysis/google-track-user-acq.md) (UAS) がオペレーショナルデータベースに格納されていません。 これが問題となるほとんどの状況では、UAS は [!DNL Google Analytics] または他の web 分析ツールを使用します。 これらのツールは非常に貴重なものですが、UAS をその中にのみ保存するといくつかの欠点があります。例えば、これらのツールからユーザーレベルのデータを抽出することはできません。 可能な場合は、通常は難しいプロセスです。 この情報を取得し、他のソースのデータ（行動情報やトランザクション情報など）と容易に結び付けることができます。また、データベースに保存されているデータも含まれます。

UAS を独自のデータベースに格納することは、多くの場合、オンラインビジネスが分析機能に対して実現できる最大の改善点です。 これにより、UAS 別のセールス、ユーザーエンゲージメント、回収期間、顧客のライフタイム値、チャーン、その他の重要な指標を分析できます。 [このデータは、マーケティングリソースに投資する場所を決定する際に重要です](../data-analyst/analysis/most-value-source-channel.md).

最低コストで新規ユーザーを獲得できるチャネルを見つけることに専念する企業が多すぎますが、各チャネルから獲得したユーザーの質を追跡しないと、ビジネス価値を生み出さないユーザーを引き付けるリスクが生じます。

## データテーブルの設定

### プライマリキーの設定

A [プライマリキー](http://en.wikipedia.org/wiki/Unique_key) は、テーブル内の一意の値を生成する、変更されない列（または列のセット）です。 プライマリキーは、 [!DNL MBI].

プライマリキーを作成する場合は、自動的に増加する列に整数データ型を使用します。 また、可能な限り、複数の列のプライマリキーを使用しないことをお勧めします。

テーブルが SQL ビューの場合は、プライマリキーとして機能する列を追加します。 [!DNL MBI] は、この列をプライマリキーとして自動的に識別できます。

### データ列へのデータタイプの割り当て

データ列に [データタイプ](http://en.wikipedia.org/wiki/Data_type), [!DNL MBI] は、使用するデータタイプを推測します。 システムが正しく推測しない場合は、サポートチームが列を適切なデータタイプに調整するまで、関連する分析を実行できない可能性があります。 例えば、日付列が数値データ型と見なされる場合、その日付ディメンションを使用して、経時的なトレンドを表示できます。

### 複数のデータベースがある場合は、データテーブルに接頭辞を追加します

複数のデータベースが [!DNL MBI]を使用する場合、混乱を避けるために、テーブルにプレフィックスを追加することをお勧めします。 プレフィックスは、指標またはデータディメンションのソースを記憶するのに役立ちます。
