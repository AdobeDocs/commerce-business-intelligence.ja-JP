---
title: 分析のためのデータベースの最適化
description: 分析用にデータベースを最適化する方法を説明します。
exl-id: e73e1a1e-c933-476d-97bc-bd8f52bb2fa1
role: Admin, Data Architect, Data Engineer, User
feature: Business Performance, Data Integration, Data Import/Export, Data Warehouse Manager
source-git-commit: adb7aaef1cf914d43348abf5c7e4bec7c51bed0c
workflow-type: tm+mt
source-wordcount: '864'
ht-degree: 0%

---

# データベースの最適化

運用データベースを使用する主なメリット [!DNL Adobe Commerce Intelligence] は、データを収集するために何も構築または変更する必要がないということです。 貴重な情報は既に存在します。ロックを解除するだけです。

このトピックには、分析のためにデータベースを最適化し、生データから実用的なインサイトを引き出すのに役立つ推奨事項が含まれています。

## データを削除しない

>[!TIP]
>
>お客様のビジネス（およびお客様自身の利用規約）に影響を与える地域および国際法は、保持できるデータの種類と保持期間に影響を与える可能性があります。 これらの法律を遵守することが最優先事項です。

注文がキャンセルされた場合、ユーザーがアカウントをアクティベート解除した場合、または製品が廃止された場合、データベース内の関連する情報が削除されます。 テーブルが増え、散乱を排除することは、賢明なアイデアのように思えます。 ただし、行を削除すると、この情報が永久に失われるか、古いバックアップを調べて見つける必要があります。

代わりに、テーブルにステータス列を追加できます。この列は、行がアクティブまたは関連しなくなったことを示します。 変更が行われた日付を格納する列を追加するか、過去の変更のログを作成することもお勧めします。 テーブルが大きくなってパフォーマンスが低下し始めた場合は、分析に使用するテーブルに古いデータをアーカイブすることを検討します。

## データを上書きする

データの上書きは、慎重かつ慎重に行う必要があります。

例えばログイン日を使用すると、多くの会社では、ログイン履歴のテーブルではなく、最終ログイン日を保存します。 機能上の目的でのみ最終ログイン日が必要となる場合がありますが、上書きされたデータは、分析の観点からは大きな損失となります。 これらのアクションの完全なログを保持しないと、長時間滞在していたユーザーの数を確認してから再アクティブ化する機能がなくなります。 また、ログインに基づくユーザーエンゲージメントコホート分析などを構築できなくなります。

通常、何らかのユーザーアクションが原因でレコードを更新する場合は、前のユーザーアクションや別のユーザーアクションに関する情報を上書きしないでください。

## 次を含める `Updated_at` 更新されたデータの列

テーブルの行に、時間の経過と共に変化する値が含まれる場合。例： **order\_status** 変更元`processing` 対象： `complete`、に含める **更新\_at** 最新の変更が発生した際に記録する列。 以下を確認します **更新\_at** 値は、新しいデータ行を最初に挿入するときに、 **更新\_at** 日付はに対応しています **created\_at** 日付。

分析の最適化に加えて、 **更新\_at** 列では、以下も使用できます [増分レプリケーション方法](../data-analyst/data-warehouse-mgr/cfg-replication-methods.md)を使用すると、更新サイクルの長さを短縮できます。

## ユーザー獲得ソースの保存

最もよくある間違いの一つは次のものである： [ユーザー獲得ソース](../data-analyst/analysis/google-track-user-acq.md) （UAS）がオペレーショナルデータベースに保存されていない。 これが問題となる状況では、ほとんどの場合、UAS は追跡されるだけです [!DNL Google Analytics] またはその他の web 分析ツールです。 これらのツールは役に立ちますが、UAS を排他的に保存することには、いくつかの欠点があります。例えば、これらのツールからユーザーレベルのデータを抽出することはできません。 可能な場合、通常は難しいプロセスです。 この情報を取得して、データベースに保存されている行動データやトランザクション情報など、他のソースのデータと結合するのは簡単です。

UAS を独自のデータベースに格納することは、多くの場合、オンラインビジネスが分析機能に対して行える最大の改善点です。 これにより、UAS による売上高、ユーザーエンゲージメント、回収期間、顧客生涯価値、チャーン、その他の重要な指標の分析が可能になります。 [このデータは、マーケティングリソースを投資する場所を決定する際に重要です](../data-analyst/analysis/most-value-source-channel.md).

あまりに多くの企業は、最小限のコストで新しいユーザーを提供するチャネルの発見にのみ注力しています。 各チャネルから獲得したユーザーの質をトラッキングしないと、ビジネス価値を生み出さないユーザーを引き付けるリスクがあります。

## データ テーブルの設定

### プライマリキーを設定

A [プライマリキー](https://en.wikipedia.org/wiki/Unique_key) は、テーブル内に一意の値を生成する、変更されない列（または列のセット）です。 プライマリキーは、テーブルが適切にレプリケートされるようにするため、非常に重要です。 [!DNL Commerce Intelligence].

プライマリキーを作成する場合、自動的に増加する列に整数データタイプを使用します。 Adobeでは、可能な限り複数の列のプライマリキーを使用しないことをお勧めします。

テーブルが SQL ビューの場合は、主キーとして機能する列を追加します。 [!DNL Commerce Intelligence] は、この列をプライマリキーとして自動的に識別できます。

### データ列へのデータタイプの割り当て

データ列にが割り当てられていません [データタイプ](https://en.wikipedia.org/wiki/Data_type), [!DNL Commerce Intelligence] 使用するデータタイプを推測します。 Adobeが誤って推測した場合、システムサポートチームが列を適切なデータタイプに変更するまで、関連分析を実行できない可能性があります。 例えば、日付列が数値データ型と推測される場合、その日付次元を使用して時系列のトレンドを分析できます。

### 複数のデータベースがある場合は、データテーブルにプレフィックスを追加します

に接続されているデータベースが複数ある場合 [!DNL Commerce Intelligence]Adobeは、混乱を避けるために、テーブルにプレフィックスを追加することをお勧めします。 プレフィックスを使用すると、指標やデータディメンションのソースを覚えておくことができます。
