---
title: 分析のためのデータベースの最適化
description: 分析用にデータベースを最適化する方法を説明します。
exl-id: e73e1a1e-c933-476d-97bc-bd8f52bb2fa1
role: Admin, Data Architect, Data Engineer, User
feature: Business Performance, Data Integration, Data Import/Export, Data Warehouse Manager
source-git-commit: adb7aaef1cf914d43348abf5c7e4bec7c51bed0c
workflow-type: tm+mt
source-wordcount: '864'
ht-degree: 0%

---

# データベースの最適化

運用データベースを [!DNL Adobe Commerce Intelligence] 用する主な利点は、データを収集するために何も作成または変更する必要がないことです。 貴重な情報は既に存在します。ロックを解除するだけです。

このトピックには、分析のためにデータベースを最適化し、生データから実用的なインサイトを引き出すのに役立つ推奨事項が含まれています。

## データを削除しない

>[!TIP]
>
>お客様のビジネス（およびお客様自身の利用規約）に影響を与える地域および国際法は、保持できるデータの種類と保持期間に影響を与える可能性があります。 これらの法律を遵守することが最優先事項です。

注文がキャンセルされた場合、ユーザーがアカウントをアクティベート解除した場合、または製品が廃止された場合、データベース内の関連する情報が削除されます。 テーブルが増え、散乱を排除することは、賢明なアイデアのように思えます。 ただし、行を削除すると、この情報が永久に失われるか、古いバックアップを調べて見つける必要があります。

代わりに、テーブルにステータス列を追加できます。この列は、行がアクティブまたは関連しなくなったことを示します。 変更が行われた日付を格納する列を追加するか、過去の変更のログを作成することもお勧めします。 テーブルが大きくなってパフォーマンスが低下し始めた場合は、分析に使用するテーブルに古いデータをアーカイブすることを検討します。

## データを上書きする

データの上書きは、慎重かつ慎重に行う必要があります。

例えばログイン日を使用すると、多くの会社では、ログイン履歴のテーブルではなく、最終ログイン日を保存します。 機能上の目的でのみ最終ログイン日が必要となる場合がありますが、上書きされたデータは、分析の観点からは大きな損失となります。 これらのアクションの完全なログを保持しないと、長時間滞在していたユーザーの数を確認してから再アクティブ化する機能がなくなります。 また、ログインに基づくユーザーエンゲージメントコホート分析などを構築できなくなります。

通常、何らかのユーザーアクションが原因でレコードを更新する場合は、前のユーザーアクションや別のユーザーアクションに関する情報を上書きしないでください。

## 時間の経過と共に更新されたデータの `Updated_at` 列を含める

たとえば、テーブルのローが時間の経過に伴って値が変化する場合、たとえば **order\_status** が `processing` から `complete` に変化する場合は、**updated\_at** カラムを含めて、最新の変化が発生したときに記録します。 **updated\_at** 日付が **created\_at** 日付に対応している場合は、新しいデータ行を最初に挿入するときに **updated\_at** 値が使用可能であることを確認します。

**updated\_at** 列では、分析の最適化に加えて、[&#x200B; 増分複製方法 &#x200B;](../data-analyst/data-warehouse-mgr/cfg-replication-methods.md) を使用することもできます。これにより、更新サイクルの長さを短縮できます。

## ストアユーザー獲得Source

最も一般的な間違いの 1 つは、[&#x200B; ユーザー獲得ソース &#x200B;](../data-analyst/analysis/google-track-user-acq.md) （UAS）が運用データベースに保存されていないことです。 これが問題となる場合は、ほとんどの状況で、UAS は [!DNL Google Analytics] または他の web 分析ツールを介してのみ追跡されます。 これらのツールは役に立ちますが、UAS を排他的に保存することには、いくつかの欠点があります。例えば、これらのツールからユーザーレベルのデータを抽出することはできません。 可能な場合、通常は難しいプロセスです。 この情報を取得して、データベースに保存されている行動データやトランザクション情報など、他のソースのデータと結合するのは簡単です。

UAS を独自のデータベースに格納することは、多くの場合、オンラインビジネスが分析機能に対して行える最大の改善点です。 これにより、UAS による売上高、ユーザーエンゲージメント、回収期間、顧客生涯価値、チャーン、その他の重要な指標の分析が可能になります。 [&#x200B; このデータは、マーケティングリソースを投資する場所を決定する際に重要です &#x200B;](../data-analyst/analysis/most-value-source-channel.md)。

あまりに多くの企業は、最小限のコストで新しいユーザーを提供するチャネルの発見にのみ注力しています。 各チャネルから獲得したユーザーの質をトラッキングしないと、ビジネス価値を生み出さないユーザーを引き付けるリスクがあります。

## データ テーブルの設定

### プライマリキーを設定

[&#x200B; プライマリキー &#x200B;](https://en.wikipedia.org/wiki/Unique_key) は、テーブル内に一意の値を生成する、変更されない列（または列のセット）です。 プライマリキーは、テーブルが [!DNL Commerce Intelligence] で適切にレプリケートされるため、非常に重要です。

プライマリキーを作成する場合、自動的に増加する列に整数データタイプを使用します。 Adobeでは、可能な限り複数の列のプライマリキーを使用しないことをお勧めします。

テーブルが SQL ビューの場合は、主キーとして機能する列を追加します。 [!DNL Commerce Intelligence] は、この列をプライマリキーとして自動的に識別できます。

### データ列へのデータタイプの割り当て

データ列に [&#x200B; データ型 &#x200B;](https://en.wikipedia.org/wiki/Data_type) が割り当てられていない場合、[!DNL Commerce Intelligence] は使用するデータ型を推測します。 システムが誤って推測した場合、Adobe サポートチームが列を適切なデータタイプに調整するまで、関連分析を実行できない可能性があります。 例えば、日付列が数値データ型と推測される場合、その日付次元を使用して時系列のトレンドを分析できます。

### 複数のデータベースがある場合は、データテーブルにプレフィックスを追加します

複数のデータベースが [!DNL Commerce Intelligence] に接続されている場合、Adobeでは、混乱を避けるために、テーブルにプレフィックスを追加することをお勧めします。 プレフィックスを使用すると、指標やデータディメンションのソースを覚えておくことができます。
